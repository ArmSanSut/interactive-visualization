export const PARTY_CANON = [
  "พรรคประชาธิปัตย์",
  "พรรคประชาชาติ",
  "พรรคพลังประชารัฐ",
  "พรรคชาติไทยพัฒนา",
  "พรรคไทยสร้างไทย",
  "พรรคเศรษฐกิจไทย",
  "พรรคเสรีรวมไทย",
  "พรรคพลังท้องถิ่นไท",
  "พรรคกล้าธรรม",
  "พรรคประชาชน",
  "พรรคชาติพัฒนา",
  "พรรคชาติพัฒนากล้า",
  "พรรคท้องที่ไทย",
  "พรรคไทยภักดี",
  "พรรคครูไทยเพื่อประชาชน",
  "พรรคถิ่นกาขาวเพื่อสันติ",
  "พรรคไทยธรรม",
  "พรรคทางเลือกใหม่",
  "พรรคพลังชาติไทย",
  "พรรคไทยศรีวิไลย์",
  "พรรคพลังไทสร้างชาติ",
  "พรรคสยามพัฒนา",
  "พรรคประชาไทยพัฒนา",
  "พรรคพลังสังคมใหม่",
  "พรรคมหาชน",
  "พรรคพลังสังคมไทย",
  "พรรคพลังเพื่อไทย",
  "พรรคพลังไทยรักไทย",
  "พรรคประชานิยม",
  "พรรคพลังใหม่ไทย",
  "พรรคพลังชาติไทย",
  "พรรคประชากรไทย",
  "พรรคก้าวหน้า",
  "พรรคพลังธรรมใหม่",
  "พรรคเพื่อชาติ",
  "พรรคพลังไทยรักไทย",
  "พรรคพลังเพื่อชาติไทย",
  "พรรคครูไทยเพื่อประชาชน",
  "พรรคพลังประชาธิปไตย",
  "พรรคประชาภิวัฒน์",
  "พรรคประชาธรรมไทย",
  "พรรคไทรักธรรม",
  "พรรคสังคมประชาธิปไตยไทย",
  "พรรคเศรษฐกิจใหม่",
  "พรรคเพื่อไทย",  
  "พรรคกลาง",
  "สมาชิกวุฒิสภา",
  "อิสระ",
  "อื่นๆ",
];

export const PARTY_VARIANTS = {
  // เพื่อไทย
  เพื่อไท: "พรรคเพื่อไทย",
  เพือไทย: "พรรคเพื่อไทย",
  พรรคเพือไทย: "พรรคเพื่อไทย",
  // ก้าวไกล
  ก้าวไก: "พรรคก้าวไกล",
  ก้าวไก่: "พรรคก้าวไกล",
  พรรคก้าวไก: "พรรคก้าวไกล",
  "move forward": "พรรคก้าวไกล",
  mfp: "พรรคก้าวไกล",
  // ภูมิใจไทย
  ภูมิใจไท: "พรรคภูมิใจไทย",
  "ภูมิใจ ไทย": "พรรคภูมิใจไทย",
  "ภูมิใจไท ": "พรรคภูมิใจไทย",
  // รวมไทยสร้างชาติ
  รวมไทยสร้างชาติ: "พรรครวมไทยสร้างชาติ",
  "รวมไทย สร้างชาติ": "พรรครวมไทยสร้างชาติ",
  "พรรครวมไทย สร้างชาติ": "พรรครวมไทยสร้างชาติ",
  rtcc: "พรรครวมไทยสร้างชาติ",
  // ประชาธิปัตย์
  ประชาธิปัต: "พรรคประชาธิปัตย์",
  democrat: "พรรคประชาธิปัตย์",
  // ประชาชาติ
  ประชาชาติไทย: "พรรคประชาชาติ",
  "pracha chart": "พรรคประชาชาติ",
  // ชาติไทยพัฒนา
  "ชาติไทย พัฒนา": "พรรคชาติไทยพัฒนา",
  chartthaipattana: "พรรคชาติไทยพัฒนา",
  // ไทยสร้างไทย
  "ไทย สร้างไทย": "พรรคไทยสร้างไทย",
  "thai sang thai": "พรรคไทยสร้างไทย",
  // พลังประชารัฐ
  พลังประชาร: "พรรคพลังประชารัฐ",
  พลังประชารัด: "พรรคพลังประชารัฐ",
  "palang pracharat": "พรรคพลังประชารัฐ",
  // เสรีรวมไทย
  "เสรี รวมไทย": "พรรคเสรีรวมไทย",
  "seri ruam thai": "พรรคเสรีรวมไทย",
  // เศรษฐกิจไทย
  "เศรษฐกิจ ไท": "พรรคเศรษฐกิจไทย",
  เศรษฐกิจไท: "พรรคเศรษฐกิจไทย",
  // พลังท้องถิ่นไท
  "พลังท้องถิ่น ไทย": "พรรคพลังท้องถิ่นไท",
  พลังท้องถิ่นไทย: "พรรคพลังท้องถิ่นไท",
  // กล้าธรรม / กล้า
  กล้า: "พรรคกล้าธรรม",
  พรรคกล้า: "พรรคกล้าธรรม",
  // ส.ว. และอิสระ
  "ส.ว.": "สมาชิกวุฒิสภา",
  "สว.": "สมาชิกวุฒิสภา",
  "สมาชิก วุฒิสภา": "สมาชิกวุฒิสภา",
  สมาชิกวุฒิภา: "สมาชิกวุฒิสภา",
  senate: "สมาชิกวุฒิสภา",
  ไม่มีสังกัด: "อิสระ",
  independent: "อิสระ",
  Independent: "อิสระ",
  independence: "อิสระ",
  // อื่นๆ ภาษาอังกฤษทั่วไป
  others: "อื่นๆ",
  other: "อื่นๆ",
  misc: "อื่นๆ",
  unknown: "อื่นๆ",
};

export function normalizePartyName(name) {
  if (!name) return "อื่นๆ";
  let s = String(name).trim();

  // ตัดคำว่า พรรค ออกก่อน normalize
  s = s.replace(/^พรรค\s*/, "");

  const base = s
    .toLowerCase()
    .replace(/[“”"'\(\)\[\]\{\}<>:;,\.\!\?]/g, "")
    .replace(/\s+/g, "")
    .trim();

  // เช็คจาก variants
  for (const [k, v] of Object.entries(PARTY_VARIANTS)) {
    const kk = k.toLowerCase().replace(/\s+/g, "").trim();
    if (base === kk) return v;
  }

  // เช็คจาก canonical
  for (const canon of PARTY_CANON) {
    const cbase = canon
      .toLowerCase()
      .replace(/^พรรค\s*/, "")
      .replace(/\s+/g, "")
      .trim();
    if (base === cbase) return canon;
  }

  // เงื่อนไขพิเศษ
  if (/ส\.?ว/.test(base) || /วุฒิ/.test(base)) return "สมาชิกวุฒิสภา";
  if (/อิสระ|indepen/.test(base)) return "อิสระ";

  return "อื่นๆ";
}

export const PARTY_COLOR = {
  พรรคภูมิใจไทย: "#1E2F97",
  พรรคประชาธิปัตย์: "#00A3E0",
  พรรคประชาชน: "#FF6A00",
  พรรคเพื่อไทย: "#E60012",
  พรรคกล้าธรรม: "#008000",
  พรรครวมไทยสร้างชาติ: "#002060",
  พรรคชาติไทยพัฒนา: "#FF66B3",
  พรรคก้าวไกล: "#EF771E",
  พรรคไทยสร้างไทย: "#65408F",
  พรรคประชาชาติ: "#009688",
  พรรคเศรษฐกิจไทย: "#FFD700",
  พรรคพลังประชารัฐ: "#FFA500",
  พรรคพลังท้องถิ่นไท: "#00AAFF",
  พรรคเสรีรวมไทย: "#00FFAA",
  สมาชิกวุฒิสภา: "#777777",
  อิสระ: "#888888",
  อื่นๆ: "#bbbbbb",
};
export const partyColor = (p) => PARTY_COLOR[p] || "#bbbbbb";
